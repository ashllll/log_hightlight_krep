# Makefile for krep Advanced DLL Examples
# 
# ç¼–è¯‘æ‰€æœ‰ç¤ºä¾‹ç¨‹åºçš„ Makefile

CC = gcc
CFLAGS = -Wall -Wextra -O2 -std=c11
INCLUDES = -I../include
LDFLAGS = -L../lib
LIBS = -lkrep_advanced

# ç›®æ ‡æ–‡ä»¶
TARGETS = basic_search.exe file_search.exe performance_demo.exe

# æºæ–‡ä»¶
SOURCES = basic_search.c file_search.c performance_demo.c

.PHONY: all clean help

# é»˜è®¤ç›®æ ‡
all: $(TARGETS)
	@echo "âœ… æ‰€æœ‰ç¤ºä¾‹ç¨‹åºç¼–è¯‘å®Œæˆ!"
	@echo ""
	@echo "å¯æ‰§è¡Œæ–‡ä»¶:"
	@for target in $(TARGETS); do \
		echo "  - $$target"; \
	done
	@echo ""
	@echo "è¿è¡Œç¤ºä¾‹:"
	@echo "  ./basic_search.exe      - åŸºç¡€æœç´¢åŠŸèƒ½æ¼”ç¤º"
	@echo "  ./file_search.exe       - æ–‡ä»¶æœç´¢åŠŸèƒ½æ¼”ç¤º"
	@echo "  ./performance_demo.exe  - æ€§èƒ½æµ‹è¯•å’Œä¼˜åŒ–æ¼”ç¤º"

# ç¼–è¯‘è§„åˆ™
%.exe: %.c
	@echo "ğŸ”¨ ç¼–è¯‘ $< -> $@"
	$(CC) $(CFLAGS) $(INCLUDES) $< $(LDFLAGS) $(LIBS) -o $@

# å•ç‹¬ç¼–è¯‘ç›®æ ‡
basic_search.exe: basic_search.c
	@echo "ğŸ”¨ ç¼–è¯‘åŸºç¡€æœç´¢ç¤ºä¾‹..."
	$(CC) $(CFLAGS) $(INCLUDES) $< $(LDFLAGS) $(LIBS) -o $@

file_search.exe: file_search.c
	@echo "ğŸ”¨ ç¼–è¯‘æ–‡ä»¶æœç´¢ç¤ºä¾‹..."
	$(CC) $(CFLAGS) $(INCLUDES) $< $(LDFLAGS) $(LIBS) -o $@

performance_demo.exe: performance_demo.c
	@echo "ğŸ”¨ ç¼–è¯‘æ€§èƒ½æ¼”ç¤º..."
	$(CC) $(CFLAGS) $(INCLUDES) $< $(LDFLAGS) $(LIBS) -o $@

# æ¸…ç†ç¼–è¯‘ç»“æœ
clean:
	@echo "ğŸ—‘ï¸  æ¸…ç†ç¼–è¯‘æ–‡ä»¶..."
	rm -f $(TARGETS)
	rm -f *.o
	@echo "âœ… æ¸…ç†å®Œæˆ!"

# å¸®åŠ©ä¿¡æ¯
help:
	@echo "krep Advanced DLL Examples - ç¼–è¯‘å¸®åŠ©"
	@echo "======================================"
	@echo ""
	@echo "å¯ç”¨ç›®æ ‡:"
	@echo "  all                - ç¼–è¯‘æ‰€æœ‰ç¤ºä¾‹ (é»˜è®¤)"
	@echo "  basic_search.exe   - ç¼–è¯‘åŸºç¡€æœç´¢ç¤ºä¾‹"
	@echo "  file_search.exe    - ç¼–è¯‘æ–‡ä»¶æœç´¢ç¤ºä¾‹"
	@echo "  performance_demo.exe - ç¼–è¯‘æ€§èƒ½æ¼”ç¤º"
	@echo "  clean              - æ¸…ç†ç¼–è¯‘æ–‡ä»¶"
	@echo "  help               - æ˜¾ç¤ºæ­¤å¸®åŠ©ä¿¡æ¯"
	@echo ""
	@echo "ç¼–è¯‘è¦æ±‚:"
	@echo "  - MinGW-w64 æˆ–å…¼å®¹çš„ GCC ç¼–è¯‘å™¨"
	@echo "  - krep_advanced.dll åœ¨ ../lib/ ç›®å½•"
	@echo "  - krep_advanced.h åœ¨ ../include/ ç›®å½•"
	@echo ""
	@echo "ä½¿ç”¨ç¤ºä¾‹:"
	@echo "  make                # ç¼–è¯‘æ‰€æœ‰ç¤ºä¾‹"
	@echo "  make clean          # æ¸…ç†æ–‡ä»¶"
	@echo "  make basic_search.exe  # ä»…ç¼–è¯‘åŸºç¡€æœç´¢ç¤ºä¾‹"

# æµ‹è¯•ç›®æ ‡ (å¯é€‰)
test: all
	@echo "ğŸ§ª è¿è¡Œç¤ºä¾‹æµ‹è¯•..."
	@echo ""
	@echo "1. åŸºç¡€æœç´¢æµ‹è¯•:"
	@./basic_search.exe
	@echo ""
	@echo "2. æ–‡ä»¶æœç´¢æµ‹è¯•:"
	@./file_search.exe  
	@echo ""
	@echo "3. æ€§èƒ½æ¼”ç¤ºæµ‹è¯•:"
	@./performance_demo.exe
	@echo ""
	@echo "âœ… æ‰€æœ‰æµ‹è¯•å®Œæˆ!"